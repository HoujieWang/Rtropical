}
}
cl = makeCluster(detectCores())
while (t < nsample){
# Find a new proposal by changing a randomly selected vertex of the current polytope
current_choice = samples[t, ]
current_obj = tropca_objs[t]
proposal <- current_choice + runif(e*pcs, -range, range)
new_obj = f(proposal)
# Compute the probability we accept the new PCA base
p = min(1, new_obj/current_obj)
if (p < 1) p = 0
if(sample(c(0, 1), 1, prob = c(1 - p, p)) == 1){
print(new_obj)
samples[(t + 1), ] <- proposal
tropca_objs[(t + 1)] <- new_obj
t = t + 1
}
}
new_pc = matrix(samples[which.max(tropca_objs), ], ncol = pcs)
proj <- parLapply(cl, x_list, troproj , tconv = new_pc)
cl = makeCluster(detectCores())
proj <- parLapply(cl, x_list, troproj , tconv = new_pc)
proj = do.call("rbind", proj)
temp = do.call("rbind", x_list) - proj
obj = sum(rowMaxs(temp, value = T) - rowMins(temp, value = T))
d0 = tropFW(proj)
d0[[2]]/(d0[[2]]+obj)
d0_2[[2]]/(tropca_fit$obj+d0_2[[2]])
f(samples[1, ])
max(tropca_objs)
setwd("~/Documents/GitHub/houjiewang.github.io")
setwd("~/Documents/GitHub/houjiewang.github.io/images")
?tropca
library(Rtropical)
tropca
setwd("~/Downloads/Research/Tropical/R pack for SVM & PCA")
setwd("~/Downloads/Research/Tropical/R pack for SVM & PCA/Code")
load("porp_var.RData")
load("prop_var.RData")
par(mfrow = c(1, 2))
plot(all_e, prop_var[1, 1: length(all_e)], type = "l", lty = 1, ylim = c(0, max(prop_var)*1.2),
xlab = "dimension", ylab = "proportion of variance",
main = paste(c("n =", "var =", "pcs ="), c(n, all_s[1], pcs), collapse = ", "))
lines(all_e, prop_var[2, 1: length(all_e)], lty = 2)
lines(all_e, prop_var[3, 1: length(all_e)], lty = 3)
legend("topright", c("tropca", "pca", "rwtropca"), lty = 1: 3)
plot(all_e, prop_var[1, (1+length(all_e)): (2*length(all_e))], type = "l", lty = 1, ylim = c(0, max(prop_var)*1.2),
xlab = "dimension", ylab = "proportion of variance",
main = paste(c("n =", "var =", "pcs ="), c(n, all_s[2], pcs), collapse = ", "))
lines(all_e, prop_var[2, (1+length(all_e)): (2*length(all_e))], lty = 2)
lines(all_e, prop_var[3, (1+length(all_e)): (2*length(all_e))], lty = 3)
legend("topright", c("tropca", "pca", "rwtropca"), lty = 1: 3)
all_e = c(10, 50, 100, 150); n = 100; all_s = c(2, 5); pcs = 2
all_parm = expand.grid(e = all_e, n = n, s = all_s)
prop_var = matrix(0, nrow = 3, ncol = nrow(all_parm))
par(mfrow = c(1, 2))
plot(all_e, prop_var[1, 1: length(all_e)], type = "l", lty = 1, ylim = c(0, max(prop_var)*1.2),
xlab = "dimension", ylab = "proportion of variance",
main = paste(c("n =", "var =", "pcs ="), c(n, all_s[1], pcs), collapse = ", "))
lines(all_e, prop_var[2, 1: length(all_e)], lty = 2)
lines(all_e, prop_var[3, 1: length(all_e)], lty = 3)
legend("topright", c("tropca", "pca", "rwtropca"), lty = 1: 3)
plot(all_e, prop_var[1, (1+length(all_e)): (2*length(all_e))], type = "l", lty = 1, ylim = c(0, max(prop_var)*1.2),
xlab = "dimension", ylab = "proportion of variance",
main = paste(c("n =", "var =", "pcs ="), c(n, all_s[2], pcs), collapse = ", "))
lines(all_e, prop_var[2, (1+length(all_e)): (2*length(all_e))], lty = 2)
lines(all_e, prop_var[3, (1+length(all_e)): (2*length(all_e))], lty = 3)
legend("topright", c("tropca", "pca", "rwtropca"), lty = 1: 3)
prop_var
prop_var
load("prop_var.RData")
par(mfrow = c(1, 2))
plot(all_e, prop_var[1, 1: length(all_e)], type = "l", lty = 1, ylim = c(0, max(prop_var)*1.2),
xlab = "dimension", ylab = "proportion of variance",
main = paste(c("n =", "var =", "pcs ="), c(n, all_s[1], pcs), collapse = ", "))
lines(all_e, prop_var[2, 1: length(all_e)], lty = 2)
lines(all_e, prop_var[3, 1: length(all_e)], lty = 3)
legend("topright", c("tropca", "pca", "rwtropca"), lty = 1: 3)
plot(all_e, prop_var[1, (1+length(all_e)): (2*length(all_e))], type = "l", lty = 1, ylim = c(0, max(prop_var)*1.2),
xlab = "dimension", ylab = "proportion of variance",
main = paste(c("n =", "var =", "pcs ="), c(n, all_s[2], pcs), collapse = ", "))
lines(all_e, prop_var[2, (1+length(all_e)): (2*length(all_e))], lty = 2)
lines(all_e, prop_var[3, (1+length(all_e)): (2*length(all_e))], lty = 3)
legend("topright", c("tropca", "pca", "rwtropca"), lty = 1: 3)
install.packages("lpSolveAPI")
install.packages("Rfast")
install.packages("parallel")
install.packages("dplyr")
install.packages("ggplot2")
library(ape)
install.packages("rbenchmark")
install.packages("e1071")
install.packages("lpSOlve")
install.packages("lpSolve")
library(caret)
library(Rtropical)
mu1 = 50.87; mu2 = 38.91
s1 = 10.47; s2 = 12.68
n1 = 15; n2 = 165
(mu1 - mu2)/sqrt( ((n1-1)*s1^2 + (n2-1)*s2^2)/(n1+n2-2) )
t = (mu1 - mu2)/sqrt( ((n1-1)*s1^2 + (n2-1)*s2^2)/(n1+n2-2) )
1 - pt(t, df = (n1+n2-2))
2*(1 - pt(t, df = (n1+n2-2)))
mu1 = 50.87; mu2 = 38.91
s1 = sqrt(10.47); s2 = sqrt(12.68)
n1 = 15; n2 = 165
t = (mu1 - mu2)/sqrt( ((n1-1)*s1^2 + (n2-1)*s2^2)/(n1+n2-2) )
t
2*(1 - pt(t, df = (n1+n2-2)))
c(28, 545, 973, 1530, 4681)/7757
eduaction = sample(c("master/phd", "bachelor", "associate", "high", "middle"), 7757, prob = c(28, 545, 973, 1530, 4681)/7757)
eduaction = sample(c("master/phd", "bachelor", "associate", "high", "middle"), 7757, replece = TRUE, prob = c(28, 545, 973, 1530, 4681)/7757)
eduaction = sample(c("master/phd", "bachelor", "associate", "high", "middle"), 7757, replace = TRUE, prob = c(28, 545, 973, 1530, 4681)/7757)
eduaction
eduaction = as.factor(sample(c("master/phd", "bachelor", "associate", "high", "middle"), 7757, replace = TRUE, prob = c(28, 545, 973, 1530, 4681)/7757))
eduaction
gender = as.factor(sample(c("male", "female"), n, replace = TRUE, prob = c(4672, 3085)/7757))
n = 7757
eduaction = as.factor(sample(c("master/phd", "bachelor", "associate", "high", "middle"), n, replace = TRUE, prob = c(28, 545, 973, 1530, 4681)/7757))
gender = as.factor(sample(c("male", "female"), n, replace = TRUE, prob = c(4672, 3085)/7757))
gender
sum(c(6060, 1698, 5, 4))
n = 7757
eduaction = as.factor(sample(c("master/phd", "bachelor", "associate", "high", "middle"), n, replace = TRUE, prob = c(28, 545, 973, 1530, 4681)/7757))
gender = as.factor(sample(c("male", "female"), n, replace = TRUE, prob = c(4672, 3085)/7757))
marital = as.factor(sample(c("married", "unmarried", "divorced", "other"), n, replace = TRUE, prob = c(6050, 1698, 5, 4)/7757))
n = 7757
eduaction = as.factor(sample(c("master/phd", "bachelor", "associate", "high", "middle"), n, replace = TRUE, prob = c(28, 545, 973, 1530, 4681)/7757))
gender = as.factor(sample(c("male", "female"), n, replace = TRUE, prob = c(4672, 3085)/7757))
marital = as.factor(sample(c("married", "unmarried", "divorced", "other"), n, replace = TRUE, prob = c(6050, 1698, 5, 4)/7757))
children = as.factor((sample(c("no", "yes"), n, replace = TRUE, prob = c(1765, 5992)/7757)))
children
cbind.data.frame(eduaction, gender, marital, children)
treatments = cbind.data.frame(eduaction, gender, marital, children)
model.matrix(~eduaction + gender + marital + children, treatments)
X = model.matrix(~eduaction + gender + marital + children, treatments)
X
as.matrix(X)
class(X)
dim(X)
beta = c(10, 6.5, -1, 1, -3.5, 1.3, 1.8, 1.2, 1, -1.5, 2.8)
pressure_idx = X %*%beta + rnorm(n, 0, 1)
dim(X)
length(beta)
X
beta = c(6.5, -1, 1, -3.5, 1.3, 1.8, 1.2, 0.2, -1.5, 2.8)
pressure_idx = X %*%beta + rnorm(n, 0, 1)
pressure_idx
sum(pressure_idx > 11)
beta = c(4.5, -1, 1, -3.5, 1.3, 1.8, 1.2, 0.2, -1.5, 2.8)
pressure_idx = X %*%beta + rnorm(n, 0, 1)
sum(pressure_idx > 11)
sum(pressure_idx < 0)
beta = c(4.5, -1, 1, -3.5, 1.2, 1.5, 1.2, 0.2, -1.5, 2)
pressure_idx = X %*%beta + rnorm(n, 0, 1)
sum(pressure_idx > 11)
sum(pressure_idx < 0)
beta = c(4.5, -1, 1, -3.5, 1.2, 1.5, 1.2, 0.2, -1.5, 2)
pressure_idx = X %*%beta + rnorm(n, 0, 0.5)
sum(pressure_idx > 11)
sum(pressure_idx < 0)
beta = c(4, -1, 1, -3.5, 1.2, 1.5, 1.2, 0.2, -1.5, 2)
pressure_idx = X %*%beta + rnorm(n, 0, 0.5)
sum(pressure_idx > 11)
sum(pressure_idx < 0)
X[which(pressure_idx < 0), ]
beta = c(4, -1, 1, -3, 1.2, 1.5, 1.2, 0.2, -1.5, 2)
pressure_idx = X %*% beta + rnorm(n, 0, 0.5)
sum(pressure_idx > 11)
sum(pressure_idx < 0)
beta = c(4, -1, 1, -3, 1.2, 1.5, 1.2, 0.2, -1.3, 2)
pressure_idx = X %*% beta + rnorm(n, 0, 0.5)
sum(pressure_idx > 11)
sum(pressure_idx < 0)
beta = c(3.5, -1, 1, -3, 1.2, 1.5, 1.2, 0.2, -1.3, 2)
pressure_idx = X %*% beta + rnorm(n, 0, 0.5)
sum(pressure_idx > 11)
sum(pressure_idx < 0)
X[pressure_idx < 0, ]
beta = c(3.5, -1, 1, -2.8, 1.2, 1.5, 1.2, 0.2, -1.3, 2)
pressure_idx = X %*% beta + rnorm(n, 0, 0.5)
sum(pressure_idx > 11)
sum(pressure_idx < 0)
X[pressure_idx < 0, ]
beta = c(3.3, -1, 1, -2.8, 1.2, 1.5, 1.2, 0.2, -1.3, 2)
pressure_idx = X %*% beta + rnorm(n, 0, 0.5)
sum(pressure_idx > 11)
sum(pressure_idx < 0)
X[pressure_idx < 0, ]
beta = c(3.3, -1, 1, -2.8, 1.2, 1.5, 1.2, 0.2, -1.3, 1.85)
pressure_idx = X %*% beta + rnorm(n, 0, 0.5)
sum(pressure_idx > 11)
sum(pressure_idx < 0)
X[pressure_idx < 0, ]
beta = c(3.3, -1, 1, -2.8, 1.2, 1.5, 1.2, 0.2, -1.3, 1.85)
pressure_idx = X %*% beta + rnorm(n, 0, 0.5)
sum(pressure_idx > 11)
sum(pressure_idx < 0)
X[pressure_idx < 0, ]
beta = c(3.3, -1, 1, -2.8, 1.2, 1.5, 1.2, 0.2, -1.3, 1.85)
pressure_idx = X %*% beta + rnorm(n, 0, 0.5)
sum(pressure_idx > 11)
sum(pressure_idx < 0)
X[pressure_idx < 0, ]
beta = c(3.3, -1, 1, -2.8, 1.2, 1.5, 1.2, 0.2, -1.3, 1.85)
pressure_idx = X %*% beta + rnorm(n, 0, 0.5)
sum(pressure_idx > 11)
sum(pressure_idx < 0)
beta = c(3.3, -1, 1, -2.8, 1.2, 1.5, 1.2, 0.2, -1.3, 1.85)
pressure_idx = X %*% beta + rnorm(n, 0, 0.5)
sum(pressure_idx > 11)
sum(pressure_idx < 0)
min(pressure_idx)
beta = c(3.3, -1, 1, -2.8, 1.2, 1.5, 1.2, 0.2, -1.3, 1.85)
pressure_idx = X %*% beta + rnorm(n, 0, 0.5)
sum(pressure_idx > 11)
sum(pressure_idx < 0)
beta = c(3.3, -1, 1, -2.8, 1.2, 1.5, 1.2, 0.2, -1.3, 1.85)
pressure_idx = X %*% beta + rnorm(n, 0, 0.5)
sum(pressure_idx > 11)
sum(pressure_idx < 0)
pressure_idx
data = cbind.data.frame(y, X)
data = cbind.data.frame(pressure_idx, X)
data
pressure_idx
range(pressure_idx)
range(round(pressure_idx, digits = 2))
pressure_idx = round(pressure_idx, digits = 2)
data = cbind.data.frame(pressure_idx, treatments)
anova(pressure_idx~eduaction, data)
aov(pressure_idx~eduaction, data)
summary(aov(pressure_idx~eduaction, data))
summary(aov(pressure_idx~gender, data))
summary(aov(pressure_idx~eduaction, data))
summary(aov(pressure_idx~gender, data))
summary(aov(pressure_idx~marital, data))
summary(aov(pressure_idx~children, data))
beta = c(3.3, -1, 1, -2.8, 1.2, 1.5, 1.2, 0.2, -1.3, 1.85)
pressure_idx = X %*% beta + rnorm(n, 0, 1)
pressure_idx = round(pressure_idx, digits = 2)
data = cbind.data.frame(pressure_idx, treatments)
summary(aov(pressure_idx~eduaction, data))
summary(aov(pressure_idx~gender, data))
summary(aov(pressure_idx~marital, data))
summary(aov(pressure_idx~children, data))
pressure_idx = X %*% beta + rnorm(n, 0, 2)
pressure_idx = round(pressure_idx, digits = 2)
data = cbind.data.frame(pressure_idx, treatments)
summary(aov(pressure_idx~eduaction, data))
summary(aov(pressure_idx~gender, data))
summary(aov(pressure_idx~marital, data))
summary(aov(pressure_idx~children, data))
pressure_idx = X %*% beta + rnorm(n, 0, 4)
pressure_idx = round(pressure_idx, digits = 2)
data = cbind.data.frame(pressure_idx, treatments)
summary(aov(pressure_idx~eduaction, data))
summary(aov(pressure_idx~gender, data))
summary(aov(pressure_idx~marital, data))
summary(aov(pressure_idx~children, data))
t.test(pressure_idx~gender, data)
summary(aov(pressure_idx~eduaction, data))
summary(aov(pressure_idx~gender, data))
summary(aov(pressure_idx~marital, data))
summary(aov(pressure_idx~children, data))
max(pressure_idx)
pressure_idx = X %*% beta + runif(n, -2, 2)
pressure_idx = round(pressure_idx, digits = 2)
data = cbind.data.frame(pressure_idx, treatments)
summary(aov(pressure_idx~eduaction, data))
summary(aov(pressure_idx~gender, data))
summary(aov(pressure_idx~marital, data))
summary(aov(pressure_idx~children, data))
pressure_idx = X %*% beta + runif(n, -3, 4)
pressure_idx = round(pressure_idx, digits = 2)
data = cbind.data.frame(pressure_idx, treatments)
summary(aov(pressure_idx~eduaction, data))
summary(aov(pressure_idx~gender, data))
summary(aov(pressure_idx~marital, data))
summary(aov(pressure_idx~children, data))
shapiro.test(pressure_idx)
shapiro.test(pressure_idx[sample(1: n, 5000, replace = F)])
hist(pressure_idx)
pressure_idx = X %*% beta + rnorm(n, 0, 1)
shapiro.test(pressure_idx[sample(1: n, 5000, replace = F)])
hist(pressure_idx)
runif(10, 11)
runif(1, 10, 11)
n = 7757
eduaction = as.factor(sample(c("master/phd", "bachelor", "associate", "high", "middle"), n, replace = TRUE, prob = c(28, 545, 973, 1530, 4681)/7757))
gender = as.factor(sample(c("male", "female"), n, replace = TRUE, prob = c(4672, 3085)/7757))
marital = as.factor(sample(c("married", "unmarried", "divorced", "other"), n, replace = TRUE, prob = c(6050, 1698, 5, 4)/7757))
children = as.factor((sample(c("no", "yes"), n, replace = TRUE, prob = c(1765, 5992)/7757)))
treatments = cbind.data.frame(eduaction, gender, marital, children)
X = model.matrix(~eduaction + gender + marital + children, treatments)
beta = c(3.3, -1, 1, -2.8, 1.2, 1.5, 1.2, 0.2, -1.3, 1.85)
pressure_idx = X %*% beta + rnorm(n, 0, 1)
shapiro.test(pressure_idx[sample(1: n, 5000, replace = F)])
pressure_idx = round(pressure_idx, digits = 2)
pressure_idx[pressure_idx > 11] = runif(sum(pressure_idx > 11), 10, 11)
pressure_idx[pressure_idx < 0] = runif(sum(pressure_idx < 0), 0, 1)
data = cbind.data.frame(pressure_idx, treatments)
summary(aov(pressure_idx~eduaction, data))
summary(aov(pressure_idx~gender, data))
summary(aov(pressure_idx~marital, data))
summary(aov(pressure_idx~children, data))
?tapply
require(stats)
groups <- as.factor(rbinom(32, n = 5, prob = 0.4))
groups
tapply(groups, groups, length)
tapply(pressure_idx, treatments$eduaction, mean)
lapply(1: ncol(treatments), function(i){tapply(pressure_idx, treatments[, i], mean)})
lapply(1: ncol(treatments), function(i){round(tapply(pressure_idx, treatments[, i], mean), digits = 2)})
lapply(1: ncol(treatments), function(i){round(tapply(pressure_idx, treatments[, i], sd), digits = 2)})
n = 7757
eduaction = as.factor(sample(c("master/phd", "bachelor", "associate", "high", "middle"), n, replace = TRUE, prob = c(28, 545, 973, 1530, 4681)/7757))
gender = as.factor(sample(c("male", "female"), n, replace = TRUE, prob = c(4672, 3085)/7757))
marital = as.factor(sample(c("married", "unmarried", "divorced", "other"), n, replace = TRUE, prob = c(6050, 1698, 5, 4)/7757))
children = as.factor((sample(c("no", "yes"), n, replace = TRUE, prob = c(1765, 5992)/7757)))
treatments = cbind.data.frame(eduaction, gender, marital, children)
X = model.matrix(~eduaction + gender + marital + children, treatments)
beta = c(3.3, -1, 1, -2.8, 1.2, 1.5, 1.2, 0.2, -1.3, 1.85)
pressure_idx = X %*% beta + rnorm(n, 0, 2)
shapiro.test(pressure_idx[sample(1: n, 5000, replace = F)])
pressure_idx = round(pressure_idx, digits = 2)
pressure_idx[pressure_idx > 11] = runif(sum(pressure_idx > 11), 10, 11)
pressure_idx[pressure_idx < 0] = runif(sum(pressure_idx < 0), 0, 1)
lapply(1: ncol(treatments), function(i){round(tapply(pressure_idx, treatments[, i], mean), digits = 2)})
lapply(1: ncol(treatments), function(i){round(tapply(pressure_idx, treatments[, i], sd), digits = 2)})
data = cbind.data.frame(pressure_idx, treatments)
summary(aov(pressure_idx~eduaction, data))
summary(aov(pressure_idx~gender, data))
summary(aov(pressure_idx~marital, data))
summary(aov(pressure_idx~children, data))
fit = lm(pressure_idx~. data)
fit = lm(pressure_idx~. ,data)
summary(fit)
n = 7757
eduaction = as.factor(sample(c("master/phd", "bachelor", "associate", "high", "middle"), n, replace = TRUE, prob = c(28, 545, 973, 1530, 4681)/7757))
gender = as.factor(sample(c("male", "female"), n, replace = TRUE, prob = c(4672, 3085)/7757))
marital = as.factor(sample(c("married", "unmarried", "divorced", "other"), n, replace = TRUE, prob = c(6050, 1698, 5, 4)/7757))
children = as.factor((sample(c("no", "yes"), n, replace = TRUE, prob = c(1765, 5992)/7757)))
treatments = cbind.data.frame(eduaction, gender, marital, children)
X = model.matrix(~eduaction + gender + marital + children, treatments)
beta = c(3.3, -1, 1, -2.8, 1.2, 1.5, 1.2, 0.2, -1.3, 1.85)
pressure_idx = X %*% beta + rnorm(n, 0, 1)
pressure_idx = round(pressure_idx, digits = 2)
pressure_idx[pressure_idx > 11] = runif(sum(pressure_idx > 11), 10, 11)
pressure_idx[pressure_idx < 0] = runif(sum(pressure_idx < 0), 0, 1)
lapply(1: ncol(treatments), function(i){round(tapply(pressure_idx, treatments[, i], mean), digits = 2)})
lapply(1: ncol(treatments), function(i){round(tapply(pressure_idx, treatments[, i], sd), digits = 2)})
data = cbind.data.frame(pressure_idx, treatments)
summary(aov(pressure_idx~eduaction, data))
summary(aov(pressure_idx~gender, data))
summary(aov(pressure_idx~marital, data))
summary(aov(pressure_idx~children, data))
fit = lm(pressure_idx~. ,data)
summary(fit)
n = 7757
eduaction = as.factor(sample(c("master/phd", "bachelor", "associate", "high", "middle"), n, replace = TRUE, prob = c(28, 545, 973, 1530, 4681)/7757))
gender = as.factor(sample(c("male", "female"), n, replace = TRUE, prob = c(4672, 3085)/7757))
marital = as.factor(sample(c("married", "unmarried", "divorced", "other"), n, replace = TRUE, prob = c(6050, 1698, 5, 4)/7757))
children = as.factor((sample(c("no", "yes"), n, replace = TRUE, prob = c(1765, 5992)/7757)))
treatments = cbind.data.frame(eduaction, gender, marital, children)
X = model.matrix(~eduaction + gender + marital + children, treatments)
beta = c(3.3, -1, 1, -2.8, 1.2, 1.5, 1.2, 0.2, -1.3, 1.85)
pressure_idx = X %*% beta + rnorm(n, 0, 1.5)
pressure_idx = round(pressure_idx, digits = 2)
pressure_idx[pressure_idx > 11] = runif(sum(pressure_idx > 11), 10, 11)
pressure_idx[pressure_idx < 0] = runif(sum(pressure_idx < 0), 0, 1)
lapply(1: ncol(treatments), function(i){round(tapply(pressure_idx, treatments[, i], mean), digits = 2)})
lapply(1: ncol(treatments), function(i){round(tapply(pressure_idx, treatments[, i], sd), digits = 2)})
data = cbind.data.frame(pressure_idx, treatments)
summary(aov(pressure_idx~eduaction, data))
summary(aov(pressure_idx~gender, data))
summary(aov(pressure_idx~marital, data))
summary(aov(pressure_idx~children, data))
fit = lm(pressure_idx~. ,data)
summary(fit)
mean_by_treatments = lapply(1: ncol(treatments), function(i){round(tapply(pressure_idx, treatments[, i], mean), digits = 2)})
std_by_treatments = lapply(1: ncol(treatments), function(i){round(tapply(pressure_idx, treatments[, i], sd), digits = 2)})
write.csv(data, file = "covid_workers.csv")
setwd("~/Downloads")
write.table(data, file = "covid_workers.xslx")
write.table(data, file = "covid_workers.xlsx")
write.csv(data, file = "covid_workers.csv")
n = 7757
eduaction = as.factor(sample(c("master/phd", "bachelor", "associate", "high", "middle"), n, replace = TRUE, prob = c(28, 545, 973, 1530, 4681)/7757))
gender = as.factor(sample(c("male", "female"), n, replace = TRUE, prob = c(4672, 3085)/7757))
marital = as.factor(sample(c("married", "unmarried", "divorced", "other"), n, replace = TRUE, prob = c(6050, 1698, 5, 4)/7757))
children = as.factor((sample(c("no", "yes"), n, replace = TRUE, prob = c(1765, 5992)/7757)))
treatments = cbind.data.frame(eduaction, gender, marital, children)
X = model.matrix(~eduaction + gender + marital + children, treatments)
beta = c(3.3, -1, 1, -2.8, 1.2, 1.5, 1.2, 0.2, -1.3, 1.85)
pressure_idx = X %*% beta + rnorm(n, 0, 1.5)
pressure_idx[pressure_idx > 11] = runif(sum(pressure_idx > 11), 10, 11)
pressure_idx[pressure_idx < 0] = runif(sum(pressure_idx < 0), 0, 1)
pressure_idx = round(pressure_idx, digits = 2)
mean_by_treatments = lapply(1: ncol(treatments), function(i){round(tapply(pressure_idx, treatments[, i], mean), digits = 2)})
std_by_treatments = lapply(1: ncol(treatments), function(i){round(tapply(pressure_idx, treatments[, i], sd), digits = 2)})
data = cbind.data.frame(pressure_idx, treatments)
summary(aov(pressure_idx~eduaction, data))
summary(aov(pressure_idx~gender, data))
summary(aov(pressure_idx~marital, data))
summary(aov(pressure_idx~children, data))
fit = lm(pressure_idx~. ,data)
summary(fit)
write.csv(data, file = "covid_workers.csv")
mean_by_treatments
std_by_treatments
fit_aov1 = aov(pressure_idx~eduaction, data)
fit_aov1$effects
coef(fit_aov1)
summary(aov(pressure_idx~eduaction, data))
summary(aov(pressure_idx~gender, data))
summary(aov(pressure_idx~marital, data))
summary(aov(pressure_idx~children, data))
n = 7757
eduaction = as.factor(sample(c("master/phd", "bachelor", "associate", "high", "middle"), n, replace = TRUE, prob = c(28, 545, 973, 1530, 4681)/7757))
gender = as.factor(sample(c("male", "female"), n, replace = TRUE, prob = c(4672, 3085)/7757))
marital = as.factor(sample(c("married", "unmarried", "divorced", "other"), n, replace = TRUE, prob = c(6050, 1698, 5, 4)/7757))
children = as.factor((sample(c("no", "yes"), n, replace = TRUE, prob = c(1765, 5992)/7757)))
treatments = cbind.data.frame(eduaction, gender, marital, children)
X = model.matrix(~eduaction + gender + marital + children, treatments)
beta = c(3.3, -1, 1, -2.8, 1.2, 1.5, 1.2, 0.2, -1.3, 1.85)
pressure_idx = X %*% beta + rnorm(n, 0, 1.5)
pressure_idx[pressure_idx > 11] = runif(sum(pressure_idx > 11), 10, 11)
pressure_idx[pressure_idx < 0] = runif(sum(pressure_idx < 0), 0, 1)
pressure_idx = round(pressure_idx, digits = 2)
mean_by_treatments = lapply(1: ncol(treatments), function(i){round(tapply(pressure_idx, treatments[, i], mean), digits = 2)})
std_by_treatments = lapply(1: ncol(treatments), function(i){round(tapply(pressure_idx, treatments[, i], sd), digits = 2)})
data = cbind.data.frame(pressure_idx, treatments)
summary(aov(pressure_idx~eduaction, data))
summary(aov(pressure_idx~gender, data))
summary(aov(pressure_idx~marital, data))
summary(aov(pressure_idx~children, data))
fit = lm(pressure_idx~. ,data)
summary(fit)
write.csv(data, file = "covid_workers.csv")
mean_by_treatments
n = 7757
eduaction = as.factor(sample(c("master/phd", "bachelor", "associate", "high", "middle"), n, replace = TRUE, prob = c(28, 545, 973, 1530, 4681)/7757))
gender = as.factor(sample(c("male", "female"), n, replace = TRUE, prob = c(4672, 3085)/7757))
marital = as.factor(sample(c("married", "unmarried", "divorced", "other"), n, replace = TRUE, prob = c(6050, 1698, 5, 4)/7757))
children = as.factor((sample(c("no", "yes"), n, replace = TRUE, prob = c(1765, 5992)/7757)))
treatments = cbind.data.frame(eduaction, gender, marital, children)
X = model.matrix(~eduaction + gender + marital + children, treatments)
beta = c(3.3, -1, 1, -2.8, 1.2, 1.5, 1.2, 0.2, -1.3, 1.85)
pressure_idx = X %*% beta + rnorm(n, 0, 1.5)
pressure_idx[pressure_idx > 11] = runif(sum(pressure_idx > 11), 10, 11)
pressure_idx[pressure_idx < 0] = runif(sum(pressure_idx < 0), 0, 1)
pressure_idx = round(pressure_idx, digits = 2)
mean_by_treatments = lapply(1: ncol(treatments), function(i){round(tapply(pressure_idx, treatments[, i], mean), digits = 2)})
names(mean_by_treatments) = c("eduaction", "gender", "marital", "children")
std_by_treatments = lapply(1: ncol(treatments), function(i){round(tapply(pressure_idx, treatments[, i], sd), digits = 2)})
names(mean_by_treatments) = c("eduaction", "gender", "marital", "children")
data = cbind.data.frame(pressure_idx, treatments)
summary(aov(pressure_idx~eduaction, data))
summary(aov(pressure_idx~gender, data))
summary(aov(pressure_idx~marital, data))
summary(aov(pressure_idx~children, data))
fit = lm(pressure_idx~. ,data)
summary(fit)
write.csv(data, file = "covid_workers.csv")
mean_by_treatments
names(std_by_treatments) = c("eduaction", "gender", "marital", "children")
std_by_treatments
max
max(data)
max(pressure_idx
)
min(pressure_idx)
n = 7757
eduaction = as.factor(sample(c("master/phd", "bachelor", "associate", "high", "middle"), n, replace = TRUE, prob = c(28, 545, 973, 1530, 4681)/7757))
gender = as.factor(sample(c("male", "female"), n, replace = TRUE, prob = c(4672, 3085)/7757))
marital = as.factor(sample(c("married", "unmarried", "divorced", "other"), n, replace = TRUE, prob = c(6050, 1698, 5, 4)/7757))
children = as.factor((sample(c("no", "yes"), n, replace = TRUE, prob = c(1765, 5992)/7757)))
treatments = cbind.data.frame(eduaction, gender, marital, children)
X = model.matrix(~eduaction + gender + marital + children, treatments)
beta = c(3.3, -1, 1, -2.8, 1.2, 1.5, 1.2, 0.2, -1.3, 1.85)
pressure_idx = X %*% beta + rnorm(n, 0, 1.5)
pressure_idx[pressure_idx > 11] = runif(sum(pressure_idx > 11), 10, 11)
pressure_idx[pressure_idx < 0] = runif(sum(pressure_idx < 0), 0.5, 1)
pressure_idx = round(pressure_idx, digits = 2)
mean_by_treatments = lapply(1: ncol(treatments), function(i){round(tapply(pressure_idx, treatments[, i], mean), digits = 2)})
names(mean_by_treatments) = c("eduaction", "gender", "marital", "children")
std_by_treatments = lapply(1: ncol(treatments), function(i){round(tapply(pressure_idx, treatments[, i], sd), digits = 2)})
names(std_by_treatments) = c("eduaction", "gender", "marital", "children")
data = cbind.data.frame(pressure_idx, treatments)
summary(aov(pressure_idx~eduaction, data))
summary(aov(pressure_idx~gender, data))
summary(aov(pressure_idx~marital, data))
summary(aov(pressure_idx~children, data))
fit = lm(pressure_idx~. ,data)
summary(fit)
write.csv(data, file = "covid_workers.csv")
max(pressure_idx)
min(pressure_idx)
mean_by_treatments
std_by_treatments
write.csv(data, file = "covid_workers.csv")
pressure_idx
n = 7757
eduaction = as.factor(sample(c("master/phd", "bachelor", "associate", "high", "middle"), n, replace = TRUE, prob = c(28, 545, 973, 1530, 4681)/7757))
gender = as.factor(sample(c("male", "female"), n, replace = TRUE, prob = c(4672, 3085)/7757))
marital = as.factor(sample(c("married", "unmarried", "divorced", "other"), n, replace = TRUE, prob = c(6050, 1698, 5, 4)/7757))
children = as.factor((sample(c("no", "yes"), n, replace = TRUE, prob = c(1765, 5992)/7757)))
treatments = cbind.data.frame(eduaction, gender, marital, children)
X = model.matrix(~eduaction + gender + marital + children, treatments)
beta = c(3.3, -1, 1, -2.8, 1.2, 1.5, 1.2, 0.2, -1.3, 1.85)
